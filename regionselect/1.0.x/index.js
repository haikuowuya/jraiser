/*!
 * JRaiser 2 Javascript Library
 * regionselect - v1.0.0 (2014-08-23T22:43:09+0800)
 * http://jraiser.org/ | Released under MIT license
 */
define("regionselect/1.0.x/",["dom/1.0.x/","ajax/1.1.x/","widget/1.0.x/","selectmenu/1.0.x/","tmpl/2.0.x/","scrollbar/1.0.x/","draggable/1.0.x/","uadetector/1.0.x/",null],function(e){"use strict";var n=e("base/1.0.x/"),t=(e("dom/1.0.x/"),e("ajax/1.1.x/")),r=e("widget/1.0.x/"),c=e("selectmenu/1.0.x/"),o=function(){var n,r=0,c=[];return function(o){2>r?(c.push(o),r||(t.jsonp(e.resolve("regionselect/data/1.x/provinces-and-cities").replace("-debug.js",".js"),{nocache:!1,callbackName:"jsonp_region_provincesAndCities",onsuccess:function(e){n=e,c.forEach(function(n){n.call(window,e)}),c=null,r=2}}),r=1)):o.call(window,n)}}(),i=function(){var n={},r={},c={};return function(o,i){var u=n[o]||0;if(2>u){var a=c[o]=c[o]||[];a.push(i),u||(t.jsonp(e.resolve("regionselect/data/1.x/counties-of-"+o).replace("-debug.js",".js"),{nocache:!1,callbackName:"jsonp_region_countiesOf"+o,onsuccess:function(e){r[o]=e,a.forEach(function(n){n.call(window,e)}),delete c[o],n[o]=2}}),n[o]=1)}else i.call(window,r[o])}}();return r.create(function(){},{_init:function(e){var t=this;o(function(r){t._provinceSelect=new c(n.extend(e.province,{optionItems:r.map(function(n){return{text:n.name,value:n[e.valueType]}}),events:{change:function(e){delete t._currentProvince,delete t._currentCity,delete t._currentCounty;for(var n=0;n<r.length;n++)if(r[n].code==e.newValue||r[n].name==e.newValue){t._currentProvince=r[n];break}t._options.city&&t._renderCities(t._currentProvince&&t._currentProvince.cities?t._currentProvince.cities:null),t._triggerChange()}}}))})},_destroy:function(){var e=this;e._provinceSelect&&e._provinceSelect.destroy(),e._citySelect&&e._citySelect.destroy(),e._countySelect&&e._countySelect.destroy(),delete e._currentProvince,delete e._currentCity},_triggerChange:function(){var e=function(e){var n;return e&&(n={name:e.name,code:e.code},e.end&&(n.end=e.end)),n};this.trigger("change",{currentProvince:e(this._currentProvince),currentCity:e(this._currentCity),currentCounty:e(this._currentCounty)})},_renderCities:function(e){var t=this;t._citySelect&&t._citySelect.destroy(),e&&(t._citySelect=new c(n.extend(t._options.city,{optionItems:e.map(function(e){return{text:e.name,value:e[t._options.valueType]}}),events:{change:function(e){delete t._currentCity,delete t._currentCounty;for(var n=t._currentProvince.cities,r=0;r<n.length;r++)if(n[r].code==e.newValue||n[r].name==e.newValue){t._currentCity=n[r];break}t._options.county&&(!t._currentCity||t._currentCity.end?t._renderCounties():t._renderCounties(t._currentProvince.code,t._currentCity.code)),t._triggerChange()}}}))),t._countySelect&&t._countySelect.destroy()},_renderCounties:function(e,t){var r=this;r._countySelect&&r._countySelect.destroy(),e&&t&&i(e,function(e){if(r._currentCity&&r._currentCity.code==t){var o=e[t];r._countySelect=new c(n.extend(r._options.county,{optionItems:o.map(function(e){return{text:e.name,value:e[r._options.valueType]}}),events:{change:function(e){delete r._currentCounty;for(var n=0;n<o.length;n++)if(o[n].code==e.newValue||o[n].name==e.newValue){r._currentCounty=o[n];break}r._triggerChange()}}}))}})}},{valueType:"code"})});